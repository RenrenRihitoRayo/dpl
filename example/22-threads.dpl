&use {std/text_io.py}

set _ = [:_meta.output_stack@append("test")]

thread test(what)
    io:println(:what)
    io:flush()
    thread::stack_op
        set _ = [:_meta.output_stack@append(:what)]
    end
end

thcall :test("Hello, world!") as th_test
thread::await_start :th_test
set _ = [:th_test@join()]